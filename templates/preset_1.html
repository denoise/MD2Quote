<!DOCTYPE html>
<html lang="{{ defaults.language }}">
<head>
    <meta charset="UTF-8">
    <title>Quotation {{ quotation.number }}</title>
    <link href="https://fonts.googleapis.com/css2?family={{ typography.heading|replace(' ', '+') }}:wght@600&family={{ typography.body|replace(' ', '+') }}:wght@400&family={{ typography.mono|replace(' ', '+') }}&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: {{ colors.primary }};
            --accent: {{ colors.accent }};
            --text: {{ colors.text }};
            --muted: {{ colors.muted }};
            --border: {{ colors.border }};
            --table-alt: {{ colors.table_alt }};
            --font-heading: '{{ typography.heading }}', sans-serif;
            --font-body: '{{ typography.body }}', sans-serif;
            --font-mono: '{{ typography.mono }}', monospace;
        }
        {% include 'preset_1.css' %}
    </style>
</head>
<body>
    <header>
        <div class="company-info">
            {% if company.show_logo and company.logo %}
            <img src="{{ company.logo }}" alt="Logo" class="logo" style="width: {{ company.logo_width|default(40) }}mm; max-height: none; height: auto;">
            {% endif %}
            {% if company.show_name %}
            <h1>{{ company.name }}</h1>
            {% endif %}
            {% if company.show_tagline %}
            <p class="tagline">{{ company.tagline }}</p>
            {% endif %}
        </div>
        <div class="quotation-meta">
            <h2>
                {% if defaults.language == 'de' %}ANGEBOT{% elif defaults.language == 'es' %}COTIZACIÓN{% else %}QUOTATION{% endif %}
            </h2>
            <table>
                {% if quotation.number %}
                <tr>
                    <td>{% if defaults.language == 'de' %}Nr.{% elif defaults.language == 'es' %}Nº{% else %}No.{% endif %}</td>
                    <td>{{ quotation.number }}</td>
                </tr>
                {% endif %}
                <tr>
                    <td>{% if defaults.language == 'de' %}Datum{% elif defaults.language == 'es' %}Fecha{% else %}Date{% endif %}</td>
                    <td>{{ quotation.date }}</td>
                </tr>
                <tr>
                    <td>{% if defaults.language == 'de' %}Gültig bis{% elif defaults.language == 'es' %}Válido hasta{% else %}Valid until{% endif %}</td>
                    <td>{{ quotation.valid_days }} {% if defaults.language == 'de' %}Tage{% elif defaults.language == 'es' %}días{% else %}days{% endif %}</td>
                </tr>
            </table>
        </div>
    </header>

    <section class="client-info">
        <h3>{% if defaults.language == 'de' %}Empfänger{% elif defaults.language == 'es' %}Señor(es){% else %}To{% endif %}</h3>
        {% if client.contact %}<p>{{ client.contact | replace('\n', '<br>') | safe }}</p>{% endif %}
        {% if client.institution %}<p><strong>{{ client.institution }}</strong></p>{% elif client.name %}<p><strong>{{ client.name }}</strong></p>{% endif %}
        {% if client.address %}<p>{{ client.address | replace('\n', '<br>') | safe }}</p>{% endif %}
        {% if client.email %}<p>{{ client.email }}</p>{% endif %}
    </section>

    <main>
        {% if snippets.intro_text %}
        <div class="intro-text">{{ snippets.intro_text }}</div>
        {% endif %}

        {{ content | safe }}
        
        {% if snippets.terms %}
        <div class="terms">
            <strong>{% if defaults.language == 'de' %}Bedingungen{% elif defaults.language == 'es' %}Términos{% else %}Terms{% endif %}:</strong> {{ snippets.terms }}
        </div>
        {% endif %}
        
        {% if snippets.signature_block %}
        <div class="signature-block">
            <div class="signature-line">
                {{ company.name }}
            </div>
        </div>
        {% endif %}
    </main>

    {% if defaults.vat_type == 'kleinunternehmer' %}
    <div class="vat-notice kleinunternehmer">
        <p>Kein Ausweis von Umsatzsteuer, da Kleinunternehmer gemäß §19 UStG.</p>
    </div>
    {% endif %}

    <footer>
        {% if snippets.custom_footer %}
        <div class="custom-footer-text">
            {{ snippets.custom_footer | replace('\n', '<br>') | safe }}
        </div>
        {% endif %}
        {% if bank.iban or bank.bank_name %}
        <div class="bank-details">
            <h4>{% if defaults.language == 'de' %}Bankverbindung{% elif defaults.language == 'es' %}Datos bancarios{% else %}Bank Details{% endif %}</h4>
            <p>{{ bank.bank_name }}{% if bank.iban %} | IBAN: {{ bank.iban }}{% endif %}{% if bank.bic %} | BIC: {{ bank.bic }}{% endif %}</p>
            {% if bank.holder %}<p>{{ bank.holder }}</p>{% endif %}
        </div>
        {% endif %}
        <div class="company-footer">
            <p>{{ contact.street }}, {{ contact.postal_code }} {{ contact.city }}, {{ contact.country }}</p>
            <p>{{ contact.email }} | {{ contact.website }}</p>
            {% if (defaults.vat_type == 'german_vat' or defaults.vat_type == 'chilean_vat') and legal.tax_id %}
            <p>{% if defaults.vat_type == 'chilean_vat' %}RUT{% elif defaults.language == 'de' %}USt-IdNr.{% elif defaults.language == 'es' %}NIF{% else %}VAT ID{% endif %}: {{ legal.tax_id }}{% if legal.chamber_of_commerce %} | KvK: {{ legal.chamber_of_commerce }}{% endif %}</p>
            {% elif legal.chamber_of_commerce %}
            <p>KvK: {{ legal.chamber_of_commerce }}</p>
            {% endif %}
        </div>
    </footer>
</body>
</html>


